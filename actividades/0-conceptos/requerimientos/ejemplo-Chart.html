<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gráfica de Usuarios por Ciudad</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; margin: 20px; }
    .chart-container { width: 80%; max-width: 800px; margin: 0 auto; }
  </style>
</head>
<body>
  <h1>Usuarios por Ciudad</h1>
  <div class="chart-container">
    <canvas id="myChart"></canvas>
  </div>

  <script>
    // 1. Obtener datos de JSONPlaceholder
    async function fetchData() {
      const response = await fetch('https://jsonplaceholder.typicode.com/users');
      const users = await response.json();
      
      // 2. Procesar datos: Contar usuarios por ciudad
      const cities = {};
      users.forEach(user => {
        const city = user.address.city;
        cities[city] = (cities[city] || 0) + 1;
      });

      return {
        labels: Object.keys(cities),
        data: Object.values(cities)
      };
    }

    // 3. Crear gráfica
    async function renderChart() {
      const { labels, data } = await fetchData();

      const ctx = document.getElementById('myChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar', // Tipo: bar, pie, line, etc.
        data: {
          labels: labels,
          datasets: [{
            label: 'Número de Usuarios',
            data: data,
            backgroundColor: [
              '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true, // Ajusta el tamaño automáticamente
          plugins: {
            legend: { display: false }, //oculta la leyenda
            tooltip: { enabled: true } // Habilita las tooltips
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }

    //nota:
    //¿Qué significa beginAtZero: true?
    //Función principal: Fuerza al eje Y a comenzar siempre en 0, 
    // sin importar los valores mínimos de tus datos.

    //Comportamiento por defecto: Si no se especifica, 
    // Chart.js ajusta automáticamente el rango del eje Y para que los datos se vean "bien", 
    // lo que puede hacer que la gráfica exagere diferencias pequeñas.



    renderChart();
  </script>
</body>
</html>